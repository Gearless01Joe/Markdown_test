# 更新日志

本文档记录 RCSB PDB 爬虫项目的版本更新历史。

## 2025年

### 2025-11-18- 文档系统建立

**新增**：
- 建立完整的项目文档系统
- 集成 MkDocs + mkdocstrings 自动生成 API 文档
- 添加快速开始、架构设计、使用示例等完整文档
- 建立故障排查指南和配置说明文档

**改进**：
- 优化文档结构，提高可读性和导航性
- 统一文档格式和风格
- 完善代码示例和使用说明

### 2025-11-17 - 增量更新功能

**新增**：
- 支持基于 `revision_date` 的增量更新模式
- Redis 存储每个结构的 revision_date，用于快速去重
- MongoDB 存储全局增量游标，记录上次更新的最大 revision_date
- 支持 `overlap_days` 参数，向前重叠若干天避免遗漏数据

**改进**：
- 优化增量游标管理逻辑
- 提高增量更新的准确性和效率
- 减少重复数据采集

### 2025-11-17 - 字段过滤功能

**新增**：
- 支持通过 JSON 配置文件自定义需要采集的字段
- `FieldFilter` 类实现灵活的字段过滤逻辑
- 支持白名单（whitelist）和黑名单（blacklist）两种模式
- 支持嵌套字段的过滤规则

**改进**：
- 大幅减少数据量和存储空间
- 提高数据采集和处理效率
- 支持按需定制数据结构

### 2025-11-17 - 文件下载功能

**新增**：
- 自动下载 CIF 结构文件
- 自动下载验证图片（validation image）
- 文件路径自动替换为 OSS 路径
- 支持文件重定向处理

**改进**：
- 优化文件下载流程
- 提高文件下载的可靠性
- 支持大文件下载

### 2025-11-17- 多模式运行支持

**新增**：
- 单条模式：支持通过 PDB ID 获取单个结构数据，用于调试和测试
- 全量模式：支持批量获取所有或指定数量的结构数据
- 增量模式：基于 revision_date 实现增量数据更新

**改进**：
- 统一三种模式的代码逻辑
- 提高代码复用性
- 优化运行效率

## 项目功能清单

### 已实现功能

- ✅ **单条数据拉取** - 通过 PDB ID 获取单个结构数据
- ✅ **批量全量采集** - 支持批量获取指定数量的结构数据
- ✅ **增量更新** - 基于 revision_date 的智能增量更新
- ✅ **字段过滤** - 灵活的字段过滤配置
- ✅ **文件下载** - 自动下载 CIF 文件和验证图片
- ✅ **MongoDB 存储** - 数据自动入库到 MongoDB
- ✅ **Redis 游标管理** - 使用 Redis 管理增量游标
- ✅ **错误重试机制** - 自动重试失败的请求
- ✅ **日志记录** - 完整的日志记录系统
- ✅ **数据验证** - 自动验证数据格式和完整性

### 计划功能

- ⏳ **数据验证和清洗** - 更完善的数据质量检查
- ⏳ **数据导出功能** - 支持导出为多种格式
- ⏳ **Web 管理界面** - 可视化的管理界面
- ⏳ **性能监控** - 实时监控采集性能
- ⏳ **自动化测试** - 完整的单元测试和集成测试
- ⏳ **数据统计** - 数据采集统计和分析
- ⏳ **告警系统** - 异常情况自动告警

## 版本说明

当前项目版本：**1.0.0**

## 贡献指南

如果你发现 Bug 或有改进建议，请：

1. 在项目中提交 Issue
2. 详细描述问题或建议
3. 提供复现步骤（如果是 Bug）
4. 说明期望的行为

## 相关文档

- [快速开始](getting-started.md) - 了解如何使用项目
- [架构设计](architecture.md) - 了解系统架构
- [使用示例](examples.md) - 查看使用示例
- [配置说明](configuration.md) - 配置参数详解
- [故障排查](troubleshooting.md) - 常见问题解决
